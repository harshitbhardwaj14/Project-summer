{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Harshit%20Bhardwaj/Desktop/project-summer/app/page.tsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { signIn, signOut, useSession } from 'next-auth/react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport './globals.css'; // Ensure global styles are imported\r\n\r\ntype Email = {\r\n  id: string;\r\n  snippet: string;\r\n  internalDate?: string;\r\n  headers?: { name: string; value: string }[];\r\n};\r\n\r\nexport default function Home() {\r\n  const { data: session, status } = useSession();\r\n  const [emails, setEmails] = useState<Email[]>([]);\r\n  const [page, setPage] = useState(1);\r\n  const [loading, setLoading] = useState(false);\r\n  const observerRef = useRef(null);\r\n\r\n  const fetchEmails = useCallback(async () => {\r\n  setLoading(true);\r\n  try {\r\n    const res = await fetch(`/api/mails?page=${page}`);\r\n    const data = await res.json();\r\n    setEmails(prev => {\r\n      const existingIds = new Set(prev.map(e => e.id));\r\n      const newEmails = (data.emails || []).filter(e => !existingIds.has(e.id));\r\n      return [...prev, ...newEmails];\r\n    });\r\n  } catch (err) {\r\n    console.error(\"Error fetching emails:\", err);\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n}, [page]);\r\n\r\n\r\n  useEffect(() => {\r\n    if (session) fetchEmails();\r\n  }, [session, fetchEmails]);\r\n\r\n  const lastEmailRef = useCallback((node: any) => {\r\n    if (loading) return;\r\n    if (observerRef.current) (observerRef.current as any).disconnect();\r\n\r\n    observerRef.current = new IntersectionObserver(entries => {\r\n      if (entries[0].isIntersecting) setPage(prev => prev + 1);\r\n    });\r\n\r\n    if (node) (observerRef.current as any).observe(node);\r\n  }, [loading]);\r\n\r\n  const formatDate = (ms: string | undefined) => {\r\n    if (!ms) return '';\r\n    const date = new Date(parseInt(ms));\r\n    return new Intl.DateTimeFormat('en-US', {\r\n      dateStyle: 'medium',\r\n      timeStyle: 'short',\r\n    }).format(date);\r\n  };\r\n\r\n  const SkeletonCard = () => (\r\n    <div className=\"bg-neutral-900/50 backdrop-blur-lg border border-neutral-800/50 rounded-2xl p-5 animate-pulse space-y-3\">\r\n      <div className=\"h-4 bg-neutral-800/50 rounded-full w-1/2\" />\r\n      <div className=\"h-4 bg-neutral-800/50 rounded-full w-1/3\" />\r\n      <div className=\"h-3 bg-neutral-800/50 rounded-full w-3/4 mt-2\" />\r\n    </div>\r\n  );\r\n\r\n  if (status === \"loading\") {\r\n    return (\r\n      <div className=\"h-screen bg-gradient-to-br from-black to-neutral-950 text-white flex items-center justify-center\">\r\n        <motion.div \r\n          initial={{ opacity: 0 }} \r\n          animate={{ opacity: 1 }} \r\n          className=\"text-lg font-medium tracking-wide bg-neutral-900/30 backdrop-blur-lg px-6 py-4 rounded-2xl border border-neutral-800/50\"\r\n        >\r\n          Loading...\r\n        </motion.div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!session) {\r\n    return (\r\n      <div className=\"h-screen bg-gradient-to-br from-black via-neutral-950 to-neutral-900 text-white flex flex-col items-center justify-center px-6 text-center\">\r\n        <motion.div \r\n          initial={{ opacity: 0, scale: 0.95 }} \r\n          animate={{ opacity: 1, scale: 1 }}\r\n          className=\"bg-neutral-900/20 backdrop-blur-xl p-10 rounded-3xl border border-neutral-800/50 shadow-2xl\"\r\n        >\r\n          <motion.h1 \r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            className=\"text-4xl font-semibold mb-6 bg-gradient-to-r from-white to-neutral-300 bg-clip-text text-transparent\"\r\n          >\r\n            Welcome to Mail Viewer\r\n          </motion.h1>\r\n          <motion.button\r\n            whileHover={{ scale: 1.04 }}\r\n            whileTap={{ scale: 0.95 }}\r\n            onClick={() => signIn('google')}\r\n            className=\"bg-white/90 text-black font-medium px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300\"\r\n          >\r\n            Sign in with Google\r\n          </motion.button>\r\n        </motion.div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-gradient-to-br from-black to-neutral-950 text-white px-4 sm:px-6 py-8 font-sans\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center mb-8 p-5 bg-neutral-900/30 backdrop-blur-lg rounded-2xl border border-neutral-800/50 shadow-lg\">\r\n          <h1 className=\"text-3xl sm:text-4xl font-bold tracking-tight bg-gradient-to-r from-white to-neutral-300 bg-clip-text text-transparent\">\r\n            ðŸ“¬ Inbox\r\n          </h1>\r\n          <motion.button\r\n            whileHover={{ scale: 1.05 }}\r\n            whileTap={{ scale: 0.95 }}\r\n            onClick={() => signOut()}\r\n            className=\"bg-white/90 text-black font-medium px-5 py-2.5 rounded-xl shadow hover:shadow-lg transition-all\"\r\n          >\r\n            Sign Out\r\n          </motion.button>\r\n        </div>\r\n\r\n        {/* Email List */}\r\n        <ul className=\"space-y-4\">\r\n          {emails.map((email, index) => {\r\n            const isLast = index === emails.length - 1;\r\n            return (\r\n              <motion.li\r\n                key={email.id}\r\n                ref={isLast ? lastEmailRef : null}\r\n                initial={{ opacity: 0, y: 10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ duration: 0.3 }}\r\n                className=\"bg-neutral-900/40 backdrop-blur-lg border border-neutral-800/50 p-5 rounded-2xl shadow-sm hover:shadow-lg transition-all hover:border-neutral-700/50\"\r\n              >\r\n                <p className=\"text-sm text-neutral-300 mb-1\">\r\n                  <span className=\"font-semibold text-white\">From:</span> {email.headers?.find(h => h.name === \"From\")?.value}\r\n                </p>\r\n                <p className=\"text-sm text-neutral-300 mb-2\">\r\n                  <span className=\"font-semibold text-white\">Subject:</span> {email.headers?.find(h => h.name === \"Subject\")?.value}\r\n                </p>\r\n                <p className=\"text-sm text-neutral-400 mt-3 mb-3\">{email.snippet}</p>\r\n                <p className=\"text-xs text-neutral-500 mt-2\">{formatDate(email.internalDate)}</p>\r\n              </motion.li>\r\n            );\r\n          })}\r\n        </ul>\r\n\r\n        {/* Skeletons */}\r\n        <div className=\"mt-6 space-y-4\">\r\n          {loading && Array.from({ length: 3 }).map((_, i) => <SkeletonCard key={i} />)}\r\n        </div>\r\n\r\n        {!loading && emails.length > 0 && (\r\n          <motion.div \r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            className=\"text-center text-neutral-500 text-sm mt-8 p-4 bg-neutral-900/20 backdrop-blur-lg rounded-2xl border border-neutral-800/50\"\r\n          >\r\n            You've reached the end of your inbox\r\n          </motion.div>\r\n        )}\r\n      </div>\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}